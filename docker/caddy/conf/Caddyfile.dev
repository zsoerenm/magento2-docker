# Development Caddyfile - uses locally generated mkcert certificates

(tls) {
  encode gzip
  tls /certs/cert.pem /certs/key.pem
}

localhost, magento.local {
  import tls

  # Mailpit web UI at /mailpit/
  handle /mailpit/* {
    reverse_proxy mailpit:8025
  }

  # Reverse proxy all requests to Varnish
  # Varnish will handle caching and forward to the appropriate backend
  reverse_proxy varnish:80 {
    header_up X-Forwarded-Proto {scheme}
    header_up X-Forwarded-For {remote}
  }
}